    *,
    *:before,
    *:after {
      -moz-box-sizing: border-box;
      -webkit-box-sizing: border-box;
      box-sizing: border-box;

      user-select: none;

      line-height: 1em;

      touch-action: manipulation;
    }

    html {
      --player-aspect-ratio: calc(9/16);
      --tile-aspect-ratio: var(--player-aspect-ratio);
      --tile-width: 24rem;
      --tile-height: calc(var(--tile-width) * var(--tile-aspect-ratio));
      --tile-border-radius: 0.6rem / 0.5rem;
      --tile-font-color: var(--text-on-tile-title);
      --tile-title-background-color: var(--bg-tile-title);
      --tile-background-color: var(--bg-tile);
      --inter-tile-margin: 1rem;

      --modal-font-color: var(--text-primary);

      --progress-bar-background-color: var(--theme-100);
      --progress-bar-position-color: var(--accent);
      --progress-bar-height: 1rem;
      --progress-bar-buffer-color: var(--theme-300);
      --trick-preview-width: max(10vw, 100px);

      --base-background-color: var(--bg-page);
      --base-overlay-color: 128,128,128;

      --default-hue: 323;
      --theme-hue: var(--default-hue);
      --theme-saturation: 100%;
      --sat-strong: clamp(0%, var(--theme-saturation), 100%);
      --sat-soft: clamp(0%, calc(var(--theme-saturation) * 0.35), 100%);
      --sat-muted: clamp(0%, calc(var(--theme-saturation) * 0.15), 100%);
      --theme-100: hsl(var(--theme-hue), var(--sat-soft), 95%);
      --theme-200: hsl(var(--theme-hue), var(--sat-soft), 88%);
      --theme-300: hsl(var(--theme-hue), var(--sat-soft), 76%);
      --theme-500: hsl(var(--theme-hue), var(--sat-strong), 50%);
      --theme-700: hsl(var(--theme-hue), var(--sat-muted), 26%);
      --theme-900: hsl(var(--theme-hue), var(--sat-muted), 14%);
      --theme-color-base: var(--theme-hue), var(--sat-strong), 50%;
      --theme-color: var(--theme-500);
      --accent: var(--theme-500);
      --accent-hover: hsl(var(--theme-hue), var(--sat-strong), 80%);
      --accent-active: hsl(var(--theme-hue), var(--sat-strong), 44%);
      --focus-ring: var(--accent);

      --folder-color: hsl(44,100%,68%);
      --file-color: #FFF;
      --playing-color: var(--theme-300);

      --primary-font-color: var(--text-primary);
      --secondary-font-color: var(--text-secondary);

      --modal-background-color: var(--bg-modal);
      --thumbnail-overlay-color: rgba(64,64,64,0.2);
      --modal-item-background: rgba(255,255,255,0.08);
      --modal-divider-color: rgba(255,255,255,0.2);
      --button-quiet-bg: rgba(255,255,255,0.08);
      --button-quiet-hover: rgba(255,255,255,0.16);
      --button-quiet-active: rgba(255,255,255,0.24);
      --text-on-accent: #ffffff;
      --text-on-tile-title: #ffffff;

      --transition-base: 300ms;
      --blur-base: 1rem;

      --subtitle-font-family: system-ui, 'Segoe UI', Calibri, Arial, Helvetica, sans-serif;
      --subtitle-size-min-base: 25.5px;
      --subtitle-size-fluid-base: 4.35vmin;
      --subtitle-size-max-base: 51px;
      --subtitle-size-scale: 1;
      --subtitle-font-size: clamp(
        calc(var(--subtitle-size-min-base) * var(--subtitle-size-scale)),
        calc(var(--subtitle-size-fluid-base) * var(--subtitle-size-scale)),
        calc(var(--subtitle-size-max-base) * var(--subtitle-size-scale))
      );
      --subtitle-color: #ffffff;
      --subtitle-background-color: #000000;
      --subtitle-cue-background-color: var(--subtitle-background-color);
      --subtitle-text-shadow: none;

      font-family: system-ui, 'Segoe UI', Calibri, Arial, Helvetica, sans-serif;
      font-size: 12px;
      background-color: var(--base-background-color);
      color: var(--primary-font-color);
    }

    @media (prefers-reduced-motion) {
      * {
        --transition-base: 0;
        transition: none !important;
        animation: none !important;
      }
    }

    html {
      /* Dark mode defaults */
      --bg-page: #0a0b0e;
      --bg-elevated: #111317;
      --bg-modal: hsla(var(--theme-hue), var(--sat-muted), 14%, 0.5);
      --bg-tile: var(--theme-900);
      --bg-tile-title: var(--theme-700);
      --text-primary: #f5f7fa;
      --text-secondary: #c7ccd4;
      --text-on-tile-title: #ffffff;
      --text-on-accent: #ffffff;
      --modal-item-background: rgba(255,255,255,0.08);
      --modal-divider-color: rgba(255,255,255,0.2);
      --button-quiet-bg: rgba(255,255,255,0.08);
      --button-quiet-hover: rgba(255,255,255,0.16);
      --button-quiet-active: rgba(255,255,255,0.24);
      --accent-hover: hsl(var(--theme-hue), var(--sat-strong), 80%);
      --accent-active: hsl(var(--theme-hue), var(--sat-strong), 44%);
    }

    :fullscreen html      { --base-background-color: hsl(var(--theme-hue), var(--sat-strong), 4%); }

    :fullscreen, :fullscreen * {
      --modal-background-color: var(--bg-modal);
    }

    body {
      display: grid;
      grid-template-areas:
        "player-container"
        "controls"
        "links"
        "footer";
      grid-template-rows: min-content min-content minmax(calc(var(--tile-height) * 2), auto) min-content;
      grid-template-columns: 1fr;

      padding: 0;
      margin: 0 auto;
    }

    .player-container {
      grid-area: player-container;
      display: grid;
      grid-template-areas:
        "player"
        "controls";
      grid-template-rows: min-content min-content;
      grid-template-columns: 1fr;


      position: relative;
      width: 100%;
      min-height: 30vw;

      z-index: 1000;
    }

    .is-audio .player-container {
      min-height: unset;
    }

    /* These two declarations must be separate. When combining the selectors Firefox doesn't apply this CSS */
    .player-container:-webkit-full-screen {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      width: 100%; /* webkit doesn't do this automatically */
      height: 100%; /* webkit doesn't do this automatically */
    }
    .player-container:fullscreen {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .player-container.drop:before {
      display: flex;
      align-items: center;
      justify-content: center;
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      content: "Drop Here";
      font-size: 5rem;
      text-shadow: 0px 0px 1.5rem #000;
      background-color: rgba(64,64,64,0.5);
      background-image: url('./assets/drop-target.svg');
      background-size: 25%;
      background-position: center;
      background-repeat: no-repeat;
      animation: pulse calc(2 * var(--transition-base)) ease-in-out alternate infinite;
      z-index: 2000;    }

    @keyframes pulse {
      0%   { opacity: 100%; }
      100% { opacity: 50% }
    }

    /* These two declarations must be separate. When combining the selectors Firefox doesn't apply this CSS */
    :-webkit-full-screen.fadeout { cursor: none; }
    :fullscreen.fadeout { cursor: none; }

    .media-container {
      position: relative;
      width: 100%;
      background: black;
      overflow: hidden;
    }

    .is-audio .media-container {
      margin-top: 1rem;
    }

    .media-title {
      position: absolute;
      top: 0;
      left: 0;
      margin: 1rem 0 0 1.5rem;
      font-size: 1.5em;
      color: rgba(255,255,255,0);
      cursor: text;
      user-select: text;
      transition: color var(--transition-base);
    }
    
    .media-container:hover .media-title,
    .media-title:hover,
    .media-title:focus,
    .media-title:focus-within {
      color: rgba(255,255,255,1);
    }

    .player {
      grid-area: player;
      width: 100%;
      max-height: 75vh;
      margin: auto;
      background-image: var(--player-poster-image, url('./assets/player-poster.svg'));
      background-size: contain;
      background-repeat: no-repeat;
      background-position: center;

      transition: filter calc(0.5 * var(--transition-base));
      will-change: filter;
    }

    .player::cue {
      font-family: var(--subtitle-font-family);
      font-size: var(--subtitle-font-size);
      color: var(--subtitle-color);
      background-color: var(--subtitle-cue-background-color);
      text-shadow: var(--subtitle-text-shadow);
    }

    body:not(.is-loaded) .player {
      min-height: max(20vw, 33vh);
    }

    .is-audio .player {
      min-height: 50vh;
      background-size: contain;
    }

    /* These two declarations must be separate. When combining the selectors Firefox doesn't apply this CSS */
    /* There should *not* be a space between `:fullscreen` and `.player` as webkit makes the `<video>` element full screen */
    :-webkit-full-screen.player {
      margin: 0;
      max-height: 100%;
      background: black !important; /* `!important` must be used to override inline styles */
    }
    /* There *must* be a space between `:fullscreen` and `.player` as other browsers allow non-<video> elements to be the fullscreen root */
    :fullscreen .player {
      margin: 0;
      max-height: 100%;
      background: black !important; /* `!important` must be used to override inline styles */
    }

    .modal.show ~ .modal-background-overlay {
      display: block;
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: transparent;
    }

    .modal {
      z-index: 100;
      display: flex;
      position: absolute;
      top: 0;
      left: 0;
      height: 100%;
      min-width: 40vw;
      max-width: 100vw;
      overflow-x: auto;

      color: var(--modal-font-color);

      margin: 0;
      transform: translateX(-100vw);
      transition:
        transform var(--transition-base) ease,
        backdrop-filter var(--transition-base) ease;
      will-change: transform, backdrop-filter;
      padding: 1rem;

      align-items: center;
      justify-content: flex-start;
      flex-direction: column;
      gap: 0.1rem;

      list-style: none;

      background-color: var(--modal-background-color);
      background-image: linear-gradient(to right, rgba(0,0,0,0.1), rgba(0,0,0,0));
      -webkit-backdrop-filter: blur(var(--blur-base));
      backdrop-filter: blur(var(--blur-base));
    }
    .modal.show { transform: translateX(0); }

    .modal:before {
      display: block;
      width: 100%;
      padding: 0.5rem 0.25rem;
      color: var(--text-primary);
      text-shadow: none;
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      font-size: 0.8rem;
    }
    .subtitle-selection:before { content: "Select a subtitle below"; }
    .settings:before { content: "Settings"; }
    .fileinfo:before { content: "File metadata"; }
    .help:before { content: "Keyboard Shortcuts" }
    .playlist:before { content: "Playlist"; }
    .open-url:before { content: "Open URL"; }

    .modal-item {
      display: flex;
      justify-content: flex-start;
      align-items: center;
      padding: 1rem;
      width: 100%;
      position: relative;
      margin: 0;
      background-color: var(--modal-item-background);
    }
    .modal-item:first-of-type {
      border-top-left-radius: 0.75rem;
      border-top-right-radius: 0.75rem;
    }
    .modal-item:last-of-type {
      border-bottom-left-radius: 0.75rem;
      border-bottom-right-radius: 0.75rem;
    }
    .modal-item .desc { overflow: visible; }

    .subtitle-item { cursor: default; }
    .subtitle-item .subtitle-choice {
      display: block;
      width: 100%;
      text-align: left;
      background: transparent;
      border: 0 none;
      border-radius: 0.25rem;
      color: var(--modal-font-color);
      padding: 0;
      margin: 0;
      cursor: pointer;
      font: inherit;
    }
    .subtitle-item:has(.subtitle-choice:hover),
    .subtitle-item:has(.subtitle-choice:focus-visible) {
      background-color: var(--button-quiet-hover);
    }
    .subtitle-item:has(.subtitle-choice:active) {
      background-color: var(--button-quiet-active);
    }
    .modal-section-heading,
    .subtitle-section-heading {
      pointer-events: none;
      cursor: default;
      padding: 0.6rem 0.25rem;
      background: transparent;
      border-radius: 0 !important;
      color: var(--text-primary);
      text-shadow: none;
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      font-size: 0.8rem;
    }
    .subtitle-settings-heading,
    .fileinfo-actions-heading {
      margin-top: 0.75rem;
      padding-top: 0.85rem;
      border-top: 1px solid var(--modal-divider-color);
    }
    .help-item { max-width: 320px; }

    .fileinfo-item .key, .help-item .key, .setting-item .key {
      display: inline-block;
      width: 12rem;
      margin-right: 1rem;
      font-weight: bold;
    }

    .fileinfo-item .value, .setting-item .value {
      display: inline-block;
      width: calc(100% - 11rem);
      user-select: text;
    }

    .help-item .key {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 12ch;
      padding: 0.75em;
      border-radius: var(--tile-border-radius);
      background-color: #333;
      text-align: center;
      gap: 1rem;
      font-weight: normal;
      font-family: Consolas, 'Courier New', Courier, monospace;
    }

    .help-item .desc { display: inline-block; }

    .modal input, .modal button {
      position: relative;
      -webkit-appearance: none;
      appearance: none;
      display: inline-flex;
      margin: 0;
      align-items: center;
      justify-content: center;
      min-width: 3.5rem;
      height: 2rem;
      z-index: 50;
      cursor: pointer;
      font-size: 0.9rem;
      overflow: hidden;
      color: black;
      border-radius: 2rem;
      outline: none;

      --input-background-color: #999;
      --input-slider-color: #FFF;
    }

    .modal select {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: auto;
      min-width: 3.5rem;
      height: 2rem;
      padding: 0 0.25rem 0 0.75rem;
      font-size: 0.9rem;
      color: black;
      border-radius: 2rem;
      outline: none;
      cursor: pointer;
      background-color: #FFF;
      border: 0 none;
      text-align: left;
      text-align-last: left;
    }
    .modal input:checked {
      --input-background-color: var(--theme-color);
    }

    .modal .reset-defaults {
      border: 0 none;
      background-color: var(--accent);
      color: var(--text-on-accent);
    }
    .modal button {
      transition:
        background-color var(--transition-base),
        color var(--transition-base),
        transform var(--transition-base);
    }
    .modal .reset-defaults:hover {
      background-color: var(--accent-hover);
    }
    .modal .reset-defaults:active {
      background-color: var(--accent-active);
      padding-top: 0.25rem;
    }

    .modal .setting-cache + .metadata {
      margin-left: 1rem;
    }

    .modal .setting-cache + .metadata::after {
      content: 'KB';
    }

    .modal .setting-item button:not(:has(svg)) {
      background-color: var(--accent);
      border: 0 none;
      color: var(--text-on-accent);
      text-shadow: none;
    }
    .modal .setting-item button:not(:has(svg)):hover,
    .modal .setting-item button:not(:has(svg)):focus-visible {
      background-color: var(--accent-hover);
    }
    .modal .setting-item button:not(:has(svg)):active {
      background-color: var(--accent-active);
      transform: translateY(1px);
    }

    .modal input[type='color'] {
      width: 2rem;
      border: 0 none;
      padding: 0;
      background-color: var(--input-background-color);
    }
    .modal input.setting-hue { --input-background-color: var(--theme-color); }
    .modal input.setting-subtitle-color { --input-background-color: var(--subtitle-color); }
    .modal input.setting-subtitle-background { --input-background-color: var(--subtitle-background-color); }

    .modal input[type='color']::-webkit-color-swatch-wrapper {
      padding: 0;
      border-radius: inherit;
    }
    .modal input[type='color']::-webkit-color-swatch {
      border: 0 none;
      border-radius: inherit;
    }
    .modal input[type='color']::-moz-color-swatch {
      border: 0 none;
      border-radius: inherit;
    }

    .modal input[type='checkbox'] {
      --width: 3.5rem;
      --diameter: 2rem;
      --spacing: 2px;
    }

    /* Checkbox background */
    .modal input[type='checkbox']:before {
      content: '';
      display: flex;
      width: 100%;
      height: 100%;

      border-radius: var(--diameter);
      background-color: var(--input-background-color);
      transition:
        left var(--transition-base),
        background-color var(--transition-base);
      will-change: left, background-color;
      color: hsl(var(--theme-hue), calc(var(--theme-saturation) * 1), 4%);
    }

    /* Checkbox slider */
    .modal input[type='checkbox']:after {
      content: 'off';
      background-color: white;
      border-radius: 50%;
      height: calc(var(--diameter) - (var(--spacing) * 2));
      width:  calc(var(--diameter) - (var(--spacing) * 2));
      position: absolute;
      top: var(--spacing);
      left: var(--spacing);
      padding: 1px;
      transition: transform var(--transition-base);
      will-change: transform;

      display: flex;
      justify-content: center;
      align-items: center;
      filter: drop-shadow(0 0 5px rgba(0,0,0,0.5));
    }
    .modal input[type='checkbox']:checked:after {
      content: 'on';
      transform: translateX(calc(var(--width) - var(--diameter)));
    }

    .playlist .playlist-controls {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      width: 100%;
      justify-content: flex-start;
    }

    .playlist .playlist-controls button:not(:has(> svg:only-child)) {
      width: auto;
      height: auto;
      padding: 0.35rem 0.75rem;
      border-radius: 1rem;
      background-color: var(--button-quiet-bg);
      color: var(--modal-font-color);
      border: 0 none;
      gap: 0.35rem;
      transition:
        background-color var(--transition-base),
        color var(--transition-base),
        transform var(--transition-base);
    }
    .playlist .playlist-controls button:not(:has(> svg:only-child)):hover {
      background-color: var(--button-quiet-hover);
    }
    .playlist .playlist-controls button:not(:has(> svg:only-child)):active {
      background-color: var(--button-quiet-active);
      transform: translateY(1px);
    }
    .playlist .playlist-controls button:not(:has(> svg:only-child)):focus-visible {
      background-color: var(--button-quiet-hover);
    }

    .playlist .playlist-controls button svg {
      width: 1rem;
      height: 1rem;
      fill: var(--modal-font-color);
    }

    .playlist-item {
      justify-content: space-between;
      gap: 0.75rem;
    }

    .playlist-item .playlist-label {
      flex: 1;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .playlist-item.current {
      background-color: rgba(0,0,0,0.4);
    }

    .playlist-item .playlist-actions {
      display: flex;
      gap: 0.35rem;
    }

    .playlist-item .playlist-actions button {
      width: 2rem;
      height: 2rem;
      padding: 0;
      border-radius: 999px;
      border: 0 none;
      background-color: transparent;
      transition:
        background-color var(--transition-base),
        transform var(--transition-base);
    }
    .playlist-item .playlist-actions button:has(> svg:only-child) {
      background-color: transparent;
    }
    .playlist-item .playlist-actions button:has(> svg:only-child):hover {
      background-color: transparent;
    }
    .playlist-item .playlist-actions button:has(> svg:only-child):active {
      background-color: transparent;
      transform: translateY(1px);
    }
    .playlist-item .playlist-actions button:has(> svg:only-child):hover svg,
    .playlist-item .playlist-actions button:has(> svg:only-child):focus-visible svg {
      fill: var(--accent-hover);
    }
    .playlist-item .playlist-actions button:has(> svg:only-child):active svg {
      fill: var(--accent-active);
    }

    .playlist-item .playlist-actions svg {
      width: 1.5rem;
      height: 1.5rem;
      fill: var(--modal-font-color);
    }

    .playlist-empty {
      justify-content: center;
      opacity: 0.7;
    }

    .open-url {
      min-width: min(44rem, 100vw);
    }
    .open-url .open-url-item {
      display: flex;
      flex-direction: column;
      align-items: stretch;
      gap: 0.75rem;
      width: 100%;
      max-width: 40rem;
    }
    .open-url .open-url-label {
      color: var(--text-primary);
      font-weight: bold;
      line-height: 1.2;
    }
    .open-url .open-url-input {
      width: 100%;
      min-width: 0;
      height: 2.25rem;
      border-radius: 0.75rem;
      border: 1px solid var(--modal-divider-color);
      background-color: rgba(255,255,255,0.92);
      color: #111;
      padding: 0 0.75rem;
      cursor: text;
    }
    .open-url .open-url-input::placeholder {
      color: rgba(0,0,0,0.5);
    }
    .open-url .open-url-error {
      min-height: 1.2em;
      margin: 0;
      color: #ffb4b4;
      font-size: 0.9rem;
      line-height: 1.2;
    }
    .open-url .open-url-actions {
      display: flex;
      align-items: center;
      justify-content: flex-end;
      gap: 0.5rem;
    }
    .open-url .open-url-actions button {
      width: auto;
      min-width: 4.5rem;
      padding: 0.35rem 0.9rem;
      border-radius: 999px;
      border: 0 none;
      color: var(--text-on-accent);
      background-color: var(--accent);
      transition:
        background-color var(--transition-base),
        color var(--transition-base),
        transform var(--transition-base);
    }
    .open-url .open-url-actions button:hover,
    .open-url .open-url-actions button:focus-visible {
      background-color: var(--accent-hover);
    }
    .open-url .open-url-actions button:active {
      background-color: var(--accent-active);
      transform: translateY(1px);
    }
    .open-url .open-url-actions .open-url-cancel {
      background-color: var(--button-quiet-bg);
      color: var(--modal-font-color);
    }
    .open-url .open-url-actions .open-url-cancel:hover,
    .open-url .open-url-actions .open-url-cancel:focus-visible {
      background-color: var(--button-quiet-hover);
    }
    .open-url .open-url-actions .open-url-cancel:active {
      background-color: var(--button-quiet-active);
    }

    .color-scheme-change-transition, .color-scheme-change-transition * {
      --transition-args: calc(var(--transition-base) * 3) ease;
      transition:
        background-color var(--transition-base),
        background-image var(--transition-base),
        color            var(--transition-base),
        fill             var(--transition-base);
    }

    .controls {
      grid-area: controls;

      display: grid;
      grid-template-areas:
        "progress-bar       progress-bar     progress-bar"
        "secondary-controls primary-controls settings-controls";
      grid-template-rows: calc(1rem + var(--progress-bar-height)) min-content;
      grid-template-columns: 1fr auto 1fr;
      row-gap: 1.25rem;

      position: relative;
      padding: 1rem;
      width: 100%;
      text-align: center;

      color: var(--primary-font-color);

      transition: transform var(--transition-base);
      will-change: transform;
      transform: none;
    }
    /* These two declarations must be separate. When combining the selectors Firefox doesn't apply this CSS */
    :-webkit-full-screen .controls {
      position: absolute;
      bottom: 0;
      background-color: rgba(var(--base-overlay-color), 1);
      --base-overlay-color: 0,0,0;

      transform: none;
    }
    :fullscreen .controls  {
      position: absolute;
      bottom: 0;
      background-color: rgba(var(--base-overlay-color), 1);
      --base-overlay-color: 0,0,0;

      transform: none;
    }
    :-webkit-full-screen.fadeout .controls { transform: translateY(100%); }
    :fullscreen.fadeout .controls  { transform: translateY(100%); }

    .controls button {
      display: inline-flex;
      justify-content: center;
      align-items: center;
      border: 0 none;
      outline: none;

      width: min(10vw, 2.5rem);
      height: min(10vw, 2.5rem);

      margin: 0rem 0.1rem;
      padding: 0;

      background: none;
      cursor: pointer;
    }

    .controls button:focus-visible,
    .modal input:focus-visible,
    .modal select:focus-visible,
    .modal button:focus-visible,
    .links a:focus-visible,
    .links .btn-add-to-playlist:focus-visible,
    .playlist .playlist-controls button:focus-visible,
    .playlist .playlist-actions button:focus-visible {
      outline: 2px solid var(--focus-ring);
      outline-offset: 1px;
    }

    .controls button svg {
      fill: var(--accent);
      min-width: 100%;
      min-height: 100%;
      max-width: 100%;
      max-height: 100%;
    }

    .no-subtitles .btn-subtitles svg { fill: hsl(var(--theme-hue), 0%, 50%); }
    .is-audio .btn-subtitles         { display: none !important; }
    .controls button:has(svg) {
      background-color: transparent;
      border-radius: 0.5rem;
    }
    .controls button:not(:has(svg)):hover,
    .controls button:not(:has(svg)):focus-visible {
      background-color: var(--button-quiet-hover);
      border-radius: 999px;
    }
    .controls button:not(:has(svg)):active {
      background-color: var(--button-quiet-active);
      border-radius: 999px;
      transform: translateY(1px);
    }
    .controls button:has(svg):hover,
    .controls button:has(svg):focus-visible,
    .controls button:has(svg):active {
      background-color: transparent;
    }
    .controls button:has(svg):hover svg,
    .controls button:has(svg):focus-visible svg {
      fill: var(--accent-hover);
    }
    .controls button:has(svg):active svg {
      fill: var(--accent-active);
    }
    .controls button:not(:has(svg)):hover svg,
    .controls button:not(:has(svg)):focus-visible svg {
      fill: var(--accent-hover);
    }
    .controls button:not(:has(svg)):active svg {
      fill: var(--accent-active);
    }
    .controls .stop svg { margin: 0 0.5rem; }

    .primary-buttons .level-0, .primary-buttons .level-1, .primary-buttons .level-2, .primary-buttons .level-3 {
      display: none;
    }

    .primary-buttons.volume-0 .level-0, .primary-buttons.volume-1 .level-1, .primary-buttons.volume-2 .level-2, .primary-buttons.volume-3 .level-3 {
      display: inline-block;
    }

    .controls .btn-playback-rate:after {
      display: block;

      color: var(--base-background-color);
      content: var(--playback-rate) 'x';
      position: absolute;
      text-align: center;

      font-weight: bold;
      font-size: min(2vw, 0.75rem);
      font-family: Arial, Helvetica, sans-serif;
    }

    /* Reset to show none */
    .btn-play-pause .pause, .btn-play-pause .play {
      display: none;
    }

    /* Show play button by default */
    .btn-play-pause .play {
      display: inline-block;
    }

    /* Loaded AND Playing */
    /* Hide play button */
    .is-loaded.is-playing .btn-play-pause .play { display: none; }
    /* Show pause button */
    .is-loaded.is-playing .btn-play-pause .pause { display: inline-block; }

    button.btn-fullscreen                          { display: none; }
    button.btn-fullscreen.enabled                  { display: inline-block; }
    .btn-fullscreen .collapse                      { display: none; } /* Hide `.collapse` by default */
    .btn-fullscreen .expand                        { display: block; } /* Show `.expand` by default */
    :-webkit-full-screen .btn-fullscreen .collapse { display: block; } /* Show collapse in fullscreen mode */
    :fullscreen          .btn-fullscreen .collapse { display: block; }
    :-webkit-full-screen .btn-fullscreen .expand   { display: none; } /* Hide collapse in fullscreen mode */
    :fullscreen          .btn-fullscreen .expand   { display: none; }
    .is-audio .btn-fullscreen                      { display: none !important; }
    
    button.btn-pip          { display: none; }
    button.btn-pip.enabled  { display: inline-block; }
    .btn-pip .exit          { display: none; } /* Hide `.exit` by default */
    .btn-pip .enter         { display: block; } /* Show `.enter` by default */
    .is-pip .btn-pip .exit  { display: block; }
    .is-pip .btn-pip .enter { display: none; }
    .is-audio .btn-pip      { display: none !important; }

    .btn-loop .loop-off { display: none; }
    .playlist-loop-off .btn-loop .loop-on { display: none; }
    .playlist-loop-off .btn-loop .loop-off { display: block; }

    .btn-previous,
    .btn-next {
      display: none;
    }
    .playlist-multiple .btn-previous,
    .playlist-multiple .btn-next {
      display: inline-flex;
    }

    .current-timestamp {
      grid-area: progress-bar;
      display: block;
      position: absolute;
      right: 0;
      top: 0;
      margin-top: calc(0.6rem + var(--progress-bar-height));
    }

    .current-timestamp .position:before { content: var(--absolute-position); }
    .current-timestamp .duration:before { content: var(--duration); }
    .current-timestamp .divider:before  { content: ' / '; }

    .progress-bar {
      grid-area: progress-bar;
      display: flex;
      align-items: center;

      z-index: 2000;
      cursor: pointer;

      position: relative;
      top: 0;
      left: 0;
      width: 100%;
      height: var(--progress-bar-height);

      border-radius: 10rem;

      background-color: var(--progress-bar-background-color);
    }

    .progress-bar::after, .progress-bar::before {
      --duration: 250ms;

      transition: all var(--duration) linear;
      transition-property: left, transform, width;
    }
    .is-paused .progress-bar::after,
    .is-paused .progress-bar::before,
    .is-stopped .progress-bar::after,
    .is-stopped .progress-bar::before {
      transition-duration: calc((1000/60) * 5); /* 3 frames */
      transition-timing-function: ease-in-out;
    }

    /* Bar */
    .progress-bar:before {
      display: block;
      content: '';
      border-radius: 1rem 0 0 1rem;
      position: absolute;
      top: 0;
      left: 0;
      height: 100%;
      width: var(--relative-position);
      background-color: var(--progress-bar-position-color);
      margin-bottom: calc(0.4rem + var(--progress-bar-height));
    }

    /* Indicator */
    .progress-bar:after {
      content: '';
      display: block;
      position: absolute;

      --indicator-position: clamp(0.45rem, var(--relative-position), calc(100% - 0.45rem));
      --indicator-size: calc(var(--progress-bar-height) + 0.4rem);
      left: clamp(
        calc(var(--indicator-size) / 2),
        var(--indicator-position),
        calc(100% - (var(--indicator-size) / 2)));
      width: var(--indicator-size);
      height: var(--indicator-size);

      margin-left: calc(var(--indicator-size) * -0.5);

      background: var(--theme-100);
      border: calc(var(--indicator-size) / 4) solid var(--accent);
      border-radius: 50%;
      filter: drop-shadow(0px 0px 1px black);
    }

    .trick-container {
      display: flex;
      align-items: center;
      justify-content: center;
      top: calc(1rem + var(--progress-bar-height));
      left: clamp(
        calc(var(--trick-preview-width)/2 + 1rem),
        var(--trick-position),
        calc(100% - var(--trick-preview-width)/2 - 1rem)
      );
      width: var(--trick-preview-width);
      margin-left: calc(var(--trick-preview-width) * -0.5);

      position: absolute;
      max-height: 0%;
      overflow: hidden;
      border-radius: 0 0 0.5rem 0.5rem;
      background: rgb(32,32,32);
      transition: max-height var(--transition-base);
      will-change: max-height;
      border: 0 none;
      box-shadow: 0 0 10px black;
      z-index: 1000;
    }

    .is-audio .trick-container {
      display: none;
    }

    .trick-container:after {
      content: '';
      width: 100%;
      height: 1rem;
      position: absolute;
      top: 0;
      left: 0;
      background-image: linear-gradient(to bottom, black, transparent);
    }  
    
    .trick {
      display: block;
      min-width: 102%;
      min-height: 102%;
      margin-left: -1%;
      margin-top: -1%;
      border: 0 none;
      filter: blur(0.5px);
      object-fit: cover;
    }  

    .is-loaded .progress-bar:hover + .trick-container {
      border: 1px solid transparent;
      height: calc(var(--trick-preview-width) * var(--player-aspect-ratio));
      max-height: 100%;
    }

      /* Only show this button if cloud streaming is enabled/possible */
    .controls .btn-cloud {
       display: none;
       padding: 0.25rem;
       max-height: 2.5rem;
    }
    .controls .btn-cloud:hover { filter: brightness(1.25); }
    .controls .btn-open-url { margin: 0 -0.1rem; }
    .controls .btn-local-file { margin: 0 -0.15rem; }
    .controls .btn-onedrive { padding: 0 0.1rem; }

    .controls .btn-fileinfo { display: none; }
    .is-loaded .controls .btn-fileinfo { display: initial; }

    .primary-buttons {
      grid-area: primary-controls;
      display: flex;
      width: 100%;
      position: relative;
      justify-content: center;
      align-items: end;
    }

    .controls-settings {
      grid-area: settings-controls;

      display: flex;
      justify-content: flex-end;
      align-items: center;
    }

    .controls-sources {
      grid-area: secondary-controls;
      display: flex;
      justify-content: flex-start;
      align-items: center;
    }

    .links {
      z-index: 500;
      grid-area: links;

      display: grid;
      gap: var(--inter-tile-margin);
      grid-template-columns: repeat(auto-fill, var(--tile-width));
      justify-content: center;

      max-width: 100vw;
      margin-top: 1rem;

      padding-bottom: 2rem;
    }

    .links a {
      /* background */
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: hidden;

      width: var(--tile-width);
      height: var(--tile-height);

      padding: 0;
      border-radius: var(--tile-border-radius);

      background-color: var(--tile-background-color);
      color: var(--tile-font-color);
      text-decoration: none;

      /* Oversize the background to crop off bad video edges */
      background-size: cover;
      background-position: center;
      background-origin: border-box;
      background-repeat: no-repeat;

      background-image: var(--image-url-0, var(--image-fallback, none));
      animation: animateThumbnail 1000ms infinite;
      animation-play-state: paused;
    }
    .links a.prerendered { animation: none; }
    .links a:hover { animation-play-state: running; }
    .no-thumbnail-animation .links a { animation: unset; }

    .links a .title {
      /* Title */
      position: absolute;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.5rem;
      bottom: 0;
      left: 0;

      width: 100%;

      overflow-wrap: break-word;
      font-size: 1.25rem;
      line-height: 1.5rem;
      text-align: left;
      padding: 1rem;

      background-color: var(--tile-title-background-color);
      border-radius: 0 0 var(--tile-border-radius) var(--tile-border-radius);

      -webkit-backdrop-filter: blur(var(--blur-base) / 4);
      backdrop-filter: blur(var(--blur-base) / 4);
    }

    .links a .title .label {
      flex: 1;
      overflow: hidden;
      text-overflow: ellipsis;
      line-height: 2rem;
    }

    .folder .title {
      justify-content: space-between;
    }

    .folder .title .folder-label {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      flex: 1;
      min-width: 0;
    }

    .folder .title .label {
      flex: 1;
      min-width: 0;
    }

    .links .btn-add-to-playlist {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: auto;
      height: auto;
      border-radius: 0;
      border: 0 none;
      background: none;
      box-shadow: none;
      color: inherit;
      cursor: pointer;
      opacity: 0.85;
    }

    .links .btn-add-to-playlist svg {
      width: 1.5rem;
      height: 1.5rem;
    }

    .links a:hover .btn-add-to-playlist { opacity: 1; }

    .links a.parent .title::after {
      content: '[Parent Folder]';
    }
    .links a.parent .title .label {
      display: none;
    }


    .links a .title .icon {
      display: none;
    }

    .links a.parent .title .icon {
      display: initial;
    }

    .folder .title svg {
      height: 1em;
      width: 1em;
      margin-bottom: -0.18em;
    }

    .file.audio-file {
      --image-fallback: url('./assets/audio-icon.svg');
      background-size: contain;
    }

    .folder .arrow,
    .file .arrow {
      /* Arrow */
      font-size: 3rem;

      display: block;
      text-align: center;
      padding: 0;
    }

    .file .arrow { filter: drop-shadow(0 0 0.1rem rgba(0, 0, 0, 0.5)); }

    .file:hover .arrow svg,
    .folder:hover .arrow svg,
    .file.current .arrow svg {
      transform: rotate(360deg);
      width: calc(var(--tile-width) / 3);
    }

    .file .arrow svg, .folder .arrow svg {
      width: calc(var(--tile-width) / 5);
      will-change: width, transform;
    }

    .file svg, .folder svg {
      --transition-options: calc(2 * var(--transition-base)) ease;
      transition:
        fill var(--transition-options),
        background-blend-mode var(--transition-options),
        transform  var(--transition-options),
        width var(--transition-options),
        height var(--transition-options);
      will-change: fill, background-blend-mode, transform, width, height;
    }
    .file svg { fill: var(--file-color); }
    .folder svg { fill: var(--folder-color); }

    .current { background-blend-mode: luminosity; }
    .current::before {
      content: "";
      width: 100%;
      height: 100%;
      position: absolute;
      top: 0;
      left: 0;
      background-color: color-mix(in srgb, var(--accent) 25%, transparent);
    }

    .file:hover .arrow svg,
    .file .btn-add-to-playlist:hover svg { fill: var(--theme-color); }
    .current .arrow svg {
      fill: var(--playing-color);
      filter: drop-shadow(0px 0px 3px var(--playing-color));
    }

    .folder .arrow .closed,
    .folder:first-of-type .arrow .open { display: block; }
    .folder .arrow .open,
    .folder:first-of-type .arrow .closed { display: none; }

    footer {
      grid-area: footer;
      display: flex;
      justify-content: center;
      margin: 2rem 0;
    }

    footer a {
      text-decoration: none;
      color: var(--secondary-font-color);
    }

    html[data-blur="disabled"] { --blur-base: 0rem; }
    html[data-transitions="disabled"] * { transition: none !important; will-change: none; }
    .no-volume .btn-volume { display: none; }

    @media (min-width: 1024px) { html { --tile-width: 24vw; } }
    @media (max-width: 1024px) { html { --tile-width: 32vw; } }
    @media (max-width: 768px)  { html { --tile-width: 48vw; } }
    @media (max-width: 500px) {
      html {
        --tile-width: 96vw;
        --progress-bar-height: 1.25rem;
      }
      .controls {
        grid-template-areas:
          "progress-bar       progress-bar"
          "timestamp          timestamp"
          "primary-controls   primary-controls"
          "secondary-controls settings-controls";
        grid-template-rows: min-content min-content min-content min-content;
        grid-template-columns: auto;
      }

      .current-timestamp {
        position: static;
        grid-area: timestamp;
        margin-top: 0.35rem;
        justify-self: end;
      }

      .controls-sources   { justify-content: flex-end; }
      .controls-settings  { justify-content: flex-start; }
      .progress-bar       { margin-bottom: 1rem; }
      .trick-container    { display: none; }
    }

    @media (prefers-color-scheme: light) {
      html {
        --bg-page: #f8f9fb;
        --bg-elevated: #ffffff;
        --bg-modal: hsla(var(--theme-hue), var(--sat-soft), 95%, 0.5);
        --bg-tile: var(--theme-100);
        --bg-tile-title: var(--theme-700);
        --text-primary: #111111;
        --text-secondary: #3a3a3a;
        --text-on-tile-title: #ffffff;
        --text-on-accent: #ffffff;
        --modal-item-background: rgba(0,0,0,0.08);
        --modal-divider-color: rgba(0,0,0,0.2);
        --button-quiet-bg: rgba(0,0,0,0.08);
        --button-quiet-hover: rgba(0,0,0,0.14);
        --button-quiet-active: rgba(0,0,0,0.22);
        --accent-hover: hsl(var(--theme-hue), var(--sat-strong), 80%);
        --accent-active: hsl(var(--theme-hue), var(--sat-strong), 36%);
      }
    }

    /* @media (prefers-color-scheme: dark) {
    } */

    /* Light mode override */
    html[data-color-scheme="light"] {
      --bg-page: #f8f9fb;
      --bg-elevated: #ffffff;
      --bg-modal: hsla(var(--theme-hue), var(--sat-soft), 95%, 0.5);
      --bg-tile: var(--theme-100);
      --bg-tile-title: var(--theme-700);
      --text-primary: #111111;
      --text-secondary: #3a3a3a;
      --text-on-tile-title: #ffffff;
      --text-on-accent: #ffffff;
      --modal-item-background: rgba(0,0,0,0.08);
      --modal-divider-color: rgba(0,0,0,0.2);
      --button-quiet-bg: rgba(0,0,0,0.08);
      --button-quiet-hover: rgba(0,0,0,0.14);
      --button-quiet-active: rgba(0,0,0,0.22);
      --accent-hover: hsl(var(--theme-hue), var(--sat-strong), 80%);
      --accent-active: hsl(var(--theme-hue), var(--sat-strong), 36%);
    }

    /* Dark mode override */
    html[data-color-scheme="dark"] {
      --bg-page: #0a0b0e;
      --bg-elevated: #111317;
      --bg-modal: hsla(var(--theme-hue), var(--sat-muted), 14%, 0.5);
      --bg-tile: var(--theme-900);
      --bg-tile-title: var(--theme-700);
      --text-primary: #f5f7fa;
      --text-secondary: #c7ccd4;
      --text-on-tile-title: #ffffff;
      --text-on-accent: #ffffff;
      --modal-item-background: rgba(255,255,255,0.08);
      --modal-divider-color: rgba(255,255,255,0.2);
      --button-quiet-bg: rgba(255,255,255,0.08);
      --button-quiet-hover: rgba(255,255,255,0.16);
      --button-quiet-active: rgba(255,255,255,0.24);
      --accent-hover: hsl(var(--theme-hue), var(--sat-strong), 80%);
      --accent-active: hsl(var(--theme-hue), var(--sat-strong), 44%);
    }
  
